define("localSiteSerializer",["lodash","coreUtils","utils","fast-json-stable-stringify"],function(e,t,n,r){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=895)}({0:function(t,n){t.exports=e},1:function(e,n){e.exports=t},16:function(e,t){e.exports=n},256:function(e,t,n){var r,a;r=[n(0)],void 0===(a=function(e){"use strict";function t(e,t){return e.localeCompare(t)}return function n(r){var a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return Array.isArray(r)?r.map(function(e){return n(e,o)}):e.isPlainObject(r)?(a={},Object.keys(r).sort(o).forEach(function(e){a[e]=n(r[e],o)}),a):r}}.apply(t,r))||(e.exports=a)},895:function(e,t,n){var r,a;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){var t="function"==typeof Map?new Map:void 0;return(u=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return s(e,arguments,f(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),c(r,e)})(e)}function s(e,t,n){return(s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&c(a,n.prototype),a}).apply(null,arguments)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r=[n(0),n(896),n(905)],void 0===(a=function(e,t,n){"use strict";var r=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=i(this,f(t).call(this,e.message))).name="DecodeError",r.path=n,r.stack=e.stack,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,u(Error)),t}();return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=a.plugins,i=void 0===o?Object.values(t):o,u=a.encodeWhenSerializing,s=void 0===u||u,c=Object.values(i),f=function(t){var n=Object.assign({},c.reduce(function(n,r){var a=r.serialize;return e.merge(n,a(t))},{}),{documentSchemaVersion:"1.0"});return s?l(n):n},p=function(t){var n=s?d(t):t;return e(i).reverse().reduce(function(t,r){var a=r.deserialize;return e.merge(t,a(n))},{})},l=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.encode,o=e.cloneDeep(t);return c.reduce(function(n,i){return i.getEncryptedPaths(o).forEach(function(o){var i=e.get(t,o);try{i&&e.set(n,o,a(i))}catch(e){throw new r(e,o)}}),n},o)},d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.decode;return l(e,t)};return{serialize:f,deserialize:p,encode:l,decode:d}}}.apply(t,r))||(e.exports=a)},896:function(e,t,n){var r,a;r=[n(0),n(897),n(898),n(899),n(900),n(901),n(902),n(903),n(904)],void 0===(a=function(e,t,n,r,a,o,i,u,s){"use strict";return{styles:t,layout:s,pages:r,menu:u,background:i,commonComponents:n,routers:o,siteInfo:a}}.apply(t,r))||(e.exports=a)},897:function(e,t,n){var r,a;r=[n(0)],void 0===(a=function(e){"use strict";function t(t){return"ComponentStyle"!==t.type&&!e.startsWith(t.id,"style-")}return{serialize:function(n){var r=n.pagesData,a=r.masterPage.data.theme_data,o=a.THEME_DATA.color,i=a.THEME_DATA.font,u=e.omit(a.THEME_DATA,"color","font");e.unset(r.masterPage.data.theme_data,"THEME_DATA");var s=e.pickBy(a,t);return e.forEach(s,function(t,n){e.unset(r.masterPage.data.theme_data,n)}),{styles:{colors:o,fonts:i,theme:u,topLevelStyles:s}}},deserialize:function(e){var t=e.styles;return{pagesData:{masterPage:{data:{theme_data:Object.assign({THEME_DATA:Object.assign({color:t.colors,font:t.fonts},t.theme)},t.topLevelStyles)}}}}},getEncryptedPaths:function(){return["styles.colors","styles.fonts","styles.theme","styles.topLevelStyles"]}}}.apply(t,r))||(e.exports=a)},898:function(e,t,n){var r,a;r=[n(0),n(256)],void 0===(a=function(e,t){"use strict";var n=function(t){var n=e.omitBy(t.theme_data,{type:"ComponentStyle"});return e.forEach(n,function(n,r){e.unset(t.theme_data,r)}),t};return{serialize:function(r){var a,o,i,u,s,c=r.pagesData,f=c.masterPage.data;return e.unset(c.masterPage,"data"),{site:{commonComponents:{structure:t((a=c.masterPage.structure,o=e.findIndex(a.children,{id:"PAGES_CONTAINER"}),i=e.findIndex(a.children,{id:"SITE_FOOTER"}),u=e.findIndex(a.children[o].components,{id:"SITE_PAGES"}),s=e.get(a,"children[".concat(o,"].layout.y")),e.set(a,"children[".concat(o,"].layout.height"),400),e.set(a,"children[".concat(i,"].layout.y"),400+s),e.set(a,"children[".concat(o,"].components[").concat(u,"].layout.height"),400),a)),data:n(f)}}}},deserialize:function(e){return{pagesData:{masterPage:e.site.commonComponents}}},getEncryptedPaths:function(){return["site.commonComponents"]}}}.apply(t,r))||(e.exports=a)},899:function(e,t,n){var r,a;function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}r=[n(0),n(256)],void 0===(a=function(e,t){"use strict";var n=function(e,t){return e?o({},t,e):{}};return{serialize:function(t){var r=t.pagesData,a=t.rendererModel,o=t.pagesPlatformApplications,i=e.reduce(o,function(t,n,r){return e.reduce(n,function(e,t,n){return e[n]=e[n]||[],e[n].push(r),e},t)},{}),u=e(r).mapValues(function(t,n){var r=t.data,a=t.structure.behaviorQuery;if(!a)return null;var o=r.behaviors_data[a],i=JSON.parse(o.items),u=e.find(i,{action:{sourceId:n},behavior:{name:"openPopup"}});return u?{behavior:o,sourceId:n,targetId:u.behavior.targetId}:null}).omitBy(e.isNull).value(),s=e.mapKeys(u,"targetId");return{pages:e(r).keys().filter(function(e){return"masterPage"!==e}).reduce(function(t,o){var c=r.masterPage.data.document_data[o],f=c.pageUriSEO,p=c.title,l=c.isPopup,d=c.id,g=s[o],m=u[o];return t[o]={pageUriSeo:f,title:p,isPopup:l,pageId:d,content:e.assign({},r[o],n(e.get(i,o),"pagesPlatformApplications"),n(a.passwordProtectedPages&&a.passwordProtectedPages.find(function(e){return e===o}),"passwordProtectedPages"))},g&&(t[o].content.lightbox_trigger=g),m&&(e.unset(r[o],["data","behaviors_data",m.behavior.id]),e.unset(r[o],["structure","behaviorQuery"])),e.unset(r.masterPage.data.document_data[o],"pageUriSEO"),e.unset(r.masterPage.data.document_data[o],"title"),t},{})}},deserialize:function(n){return{pagesData:e(n.pages).keys().filter(function(e){return"masterPage"!==e}).reduce(function(r,a){var i,u=n.pages[a].content.lightbox_trigger,s=e.omit(t(n.pages[a].content),["lightbox_trigger","pagesPlatformApplications","passwordProtectedPages"]),c=e.get(u,["behavior","id"],null),f=c?o({},u.sourceId,{data:{behaviors_data:o({},c,u.behavior)},structure:{behaviorQuery:c}}):{};return e.merge(r,f,(o(i={},a,e.assign(s,{title:n.pages[a].title,pageUriSEO:n.pages[a].pageUriSeo})),o(i,"masterPage",{data:{document_data:o({},a,{isPopup:n.pages[a].isPopup,title:n.pages[a].title,pageUriSEO:n.pages[a].pageUriSeo,id:n.pages[a].pageId})}}),i))},{}),rendererModel:Object.keys(n.pages).filter(function(e){return"masterPage"!==e}).reduce(function(e,t){var r=n.pages[t].content;return r.pagesPlatformApplications&&(e.pagesPlatformApplications[t]=r.pagesPlatformApplications),delete r.pagesPlatformApplications,e.passwordProtectedPages=e.passwordProtectedPages.concat(r.passwordProtectedPages?r.passwordProtectedPages:[]),delete r.passwordProtectedPages,e},{pagesPlatformApplications:{},passwordProtectedPages:[]})}},getEncryptedPaths:function(e){return Object.keys(e.pages).map(function(e){return"pages.".concat(e,".content")})}}}.apply(t,r))||(e.exports=a)},900:function(e,t,n){var r;void 0===(r=function(){"use strict";return{serialize:function(e){var t=e.documentServicesModel,n=e.rendererModel;return{site:Object.assign({},{siteInfo:n.siteInfo,version:{version:t.version,revision:t.revision}},n.multilingualInfo?{multilingualInfo:n.multilingualInfo}:{})}},deserialize:function(e){return{documentServicesModel:Object.assign(e.site.version),rendererModel:Object.assign({siteInfo:e.site.siteInfo},e.site.multilingualInfo?{multilingualInfo:e.site.multilingualInfo}:{})}},getEncryptedPaths:function(){return["site.siteInfo","site.revision","site.version","site.dataFromMasterPage","site.multilingualInfo"]}}}.apply(t,[]))||(e.exports=r)},901:function(e,t,n){var r,a;function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}r=[n(0)],void 0===(a=function(e){"use strict";return{serialize:function(t){var n=t.routers,r=e.get(n,"configMap",{});return{routers:Object.keys(r).reduce(function(e,t){return Object.assign(e,o({},r[t].prefix,Object.assign({},r[t],{routeId:t})))},{})}},deserialize:function(t){return{rendererModel:{routers:{configMap:Object.keys(t.routers).reduce(function(n,r){return e.merge(n,o({},t.routers[r].routeId,Object.assign({},e.omit(t.routers[r],"routeId"),{prefix:r})))},{})}}}},getEncryptedPaths:function(e){return Object.keys(e.routers).map(function(e){return"routers.".concat(e)})}}}.apply(t,r))||(e.exports=a)},902:function(e,t,n){var r,a;r=[n(0),n(16),n(1)],void 0===(a=function(e,t,n){"use strict";var r=t.siteUtils,a=function(t,n,a){return r.getPageBackgroundDataPointers(a,[n]).reduce(function(t,n){var r=n.path;return e.get(a,r)&&(e.set(t,r,e.get(a,r)),e.unset(a,r)),t},{})},o=function(t,n,a){return r.getPageBackgroundDataPointers(n.content,[a]).forEach(function(r){var a=r.path;e.get(n.content,a)&&(e.set(t,a,e.get(n.content,a)),e.unset(n.content,a))}),t};return{serialize:function(t){var r=t.pagesData,o=r[n.siteConstants.MASTER_PAGE_ID];return{pages:e(r).omit("masterPage").mapValues(function(e,t){return{content:a(0,t,o)}}).value()}},deserialize:function(t){var n=t.pages;return{pagesData:{masterPage:e(n).omit("masterPage").reduce(o,{data:{document_data:{}}})}}},getEncryptedPaths:function(e){return Object.keys(e.pages).map(function(e){return"pages.".concat(e,".content")})}}}.apply(t,r))||(e.exports=a)},903:function(e,t,n){var r,a;function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}r=[n(0)],void 0===(a=function(e){"use strict";var t=["PageLink","AnchorLink"],n=function(e){return e.replace(/^#/,"")};return{serialize:function(r){var a,o,u=r.pagesData,s={menus:{},pages:{}},c=(a=u.masterPage,o=a.data.document_data,e(o).get("CUSTOM_MENUS.menus",[]).reduce(function(t,r){var a=n(r),i=e.get(o,a);return e.set(t,a,i)},{})),f=e.reduce(c,function(t,r,a){return e.set(t,a,function(t,r){return e.flattenDeep(function r(a){var o=a.dataId,i=a.parent,u=void 0===i?null:i,s="data.document_data.".concat(n(o)),c=[],f=e.get(t,"".concat(s,".items"));return f.length>0&&c.push(f.map(function(e){return r({dataId:e,parent:n(o)})})),c.concat([{path:s,parent:u}])}({dataId:r}))}(u.masterPage,a))},{});return e.forEach(f,function(r,a){s.menus[a]=s.menus[a]||{data:{},structure:{}},e.forEach(r,function(r){var o=r.path,c=e.get(u.masterPage,o),f=c.link&&e.get(u.masterPage,"data.document_data.".concat(n(c.link)));f&&"_self"===f.target&&e.omit(f,["target"]);var p=e.assign({},i({},c.id,e.omit(c,"items")),f?i({},f.id,f):{});if(e.set(s.menus[a],"structure.".concat(c.id),{id:c.id,items:c.items}),function(e){return e&&t.includes(e.type)&&"masterPage"!==n(e.pageId)}(f)){var l=n(f.pageId);e.set(s.pages,"".concat(l,".content.menus.").concat(a),p)}else e.merge(s.menus[a].data,p);e.forEach(p,function(t,n){return e.unset(u.masterPage.data.document_data,n)}),e.unset(u.masterPage,o)})}),s},deserialize:function(t){return{pagesData:{masterPage:{data:{document_data:e.reduce(t.menus,function(r,a,i){var u,s=a.structure,c=a.data,f=e(s).map("items").flattenDeep().map(n).value(),p=e.reduce(t.pages,function(t,n){return e.assign(t,e.get(n.content,"menus.".concat(i)),{})},{}),l=e(p).filter(function(e){return"BasicMenuItem"===e.type&&!f.includes(e.id)}).map(function(e){return"#".concat(e.id)}).value();return(u=s[i].items).push.apply(u,o(l)),e.merge(r,p,c,s,l)},{})}}}}},getEncryptedPaths:function(t){return e(t.menus).keys().map(function(e){return"menus.".concat(e)}).concat(e(t.pages).keys().map(function(e){return"pages.".concat(e,".content.menus")}).value()).value()}}}.apply(t,r))||(e.exports=a)},904:function(e,t,n){var r,a;r=[n(0),n(1)],void 0===(a=function(e,t){"use strict";return{serialize:function(n){var r=n.pagesData;return{pages:e(r).omit(t.siteConstants.MASTER_PAGE_ID).mapValues(function(t,n){return a=r[n].structure,e.unset(a,"layout.width"),e.set({},"content.structure.layout.width",980);var a}).value()}},deserialize:e.noop,getEncryptedPaths:function(){return[]}}}.apply(t,r))||(e.exports=a)},905:function(e,t,n){var r,a;r=[n(0),n(906)],void 0===(a=function(e,t){"use strict";return{encode:function(n){return e.flow([t,encodeURIComponent,unescape,btoa])(n)},decode:function(t){return e.flow([atob,escape,decodeURIComponent,JSON.parse])(t)}}}.apply(t,r))||(e.exports=a)},906:function(e,t){e.exports=r}})});
//# sourceMappingURL=localSiteSerializer.min.js.map